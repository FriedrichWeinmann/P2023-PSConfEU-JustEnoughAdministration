<#
.SYNOPSIS
	This is a wrapper script around whatever data was injected into it when it was built.

.DESCRIPTION
	This is a wrapper script around whatever data was injected into it when it was built.
	To inspect what is contained, run this script with the "-ExpandTo" parameter pointing at the folder where to extract it to.
	The "run.ps1" file in the root folder is what is being executed after unwrapping it if executed without parameters.

.PARAMETER ExpandTo
	Expand the wrapped code, rather than execute it.
	Specify the folder you want it exported to.

.EXAMPLE
	PS C:\> .\JEA_OSInfo.ps1

	Execute the wrapped code.

.EXAMPLE
	PS C:\> .\JEA_OSInfo.ps1 -ExpandTo C:\temp

	Export the wrapped code to C:\temp without executing it.
#>
[CmdletBinding()]
param (
	[string]
	$ExpandTo
)

# The actual code to deploy
$payload = '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AAAAEwAAAAAAAAAAAAAAAAAAAAAATW9kdWxlcy9KRUFfT1NJbmZvL1BLAQIUABQAAAAAAHtL1lYAAAAAAAAAAAAAAAAiAAAAAAAAAAAAAAAAADEAAABNb2R1bGVzL0pFQV9PU0luZm8vMS4wLjAvaW50ZXJuYWwvUEsBAhQAFAAAAAgAe0vWVhulnxeQBQAAqRAAACgAAAAAAAAAAAAAAAAAcQAAAE1vZHVsZXMvSkVBX09TSW5mby8xLjAuMC9KRUFfT1NJbmZvLnBzZDFQSwECFAAUAAAACAD4udFWSTM897kAAAB1AgAAKAAAAAAAAAAAAAAAAABHBgAATW9kdWxlcy9KRUFfT1NJbmZvLzEuMC4wL0pFQV9PU0luZm8ucHNtMVBLAQIUABQAAAAIAHtL1lat+rxmNQMAAPYJAAAyAAAAAAAAAAAAAAAAAEYHAABNb2R1bGVzL0pFQV9PU0luZm8vMS4wLjAvc2Vzc2lvbmNvbmZpZ3VyYXRpb24ucHNzY1BLAQIUABQAAAAIAHtL1lYzH+A/YwAAAG4AAAAxAAAAAAAAAAAAAAAAAMsKAABNb2R1bGVzL0pFQV9PU0luZm8vMS4wLjAvZnVuY3Rpb25zL0dldC1PU0luZm8ucHMxUEsBAhQAFAAAAAgAe0vWVkxpnw4TAAAAEQAAACwAAAAAAAAAAAAAAAAAfQsAAE1vZHVsZXMvSkVBX09TSW5mby8xLjAuMC9mdW5jdGlvbnMvcmVhZG1lLm1kUEsBAhQAFAAAAAgAe0vWVs1dpa8IAQAA2AEAAEYAAAAAAAAAAAAAAAAA2gsAAE1vZHVsZXMvSkVBX09TSW5mby8xLjAuMC9mdW5jdGlvbnMvUmVnaXN0ZXItSmVhRW5kcG9pbnRfSkVBX09TSW5mby5wczFQSwECFAAUAAAACAB7S9ZWTGmfDhMAAAARAAAANQAAAAAAAAAAAAAAAABGDQAATW9kdWxlcy9KRUFfT1NJbmZvLzEuMC4wL2ludGVybmFsL2Z1bmN0aW9ucy9yZWFkbWUubWRQSwECFAAUAAAACAB7S9ZWAgfflWwCAABEBQAARAAAAAAAAAAAAAAAAACsDQAATW9kdWxlcy9KRUFfT1NJbmZvLzEuMC4wL2ludGVybmFsL2Z1bmN0aW9ucy9SZWdpc3Rlci1KZWFFbmRwb2ludC5wczFQSwECFAAUAAAACAB7S9ZWTGmfDhMAAAARAAAANwAAAAAAAAAAAAAAAAB6EAAATW9kdWxlcy9KRUFfT1NJbmZvLzEuMC4wL2ludGVybmFsL3NjcmlwdHNQb3N0L3JlYWRtZS5tZFBLAQIUABQAAAAIAHtL1lZsqK8PNAAAADIAAABAAAAAAAAAAAAAAAAAAOIQAABNb2R1bGVzL0pFQV9PU0luZm8vMS4wLjAvaW50ZXJuYWwvc2NyaXB0c1ByZS9fX0ltcG9ydE1vZHVsZXMucHMxUEsBAhQAFAAAAAgAe0vWVkxpnw4TAAAAEQAAADYAAAAAAAAAAAAAAAAAdBEAAE1vZHVsZXMvSkVBX09TSW5mby8xLjAuMC9pbnRlcm5hbC9zY3JpcHRzUHJlL3JlYWRtZS5tZFBLAQIUABQAAAAIAHtL1lZMaZ8OEwAAABEAAAA3AAAAAAAAAAAAAAAAANsRAABNb2R1bGVzL0pFQV9PU0luZm8vMS4wLjAvaW50ZXJuYWwvc2NyaXB0c1JvbGUvcmVhZG1lLm1kUEsBAhQAFAAAAAgAe0vWVord6HD9AwAA3hIAADUAAAAAAAAAAAAAAAAAQxIAAE1vZHVsZXMvSkVBX09TSW5mby8xLjAuMC9Sb2xlQ2FwYWJpbGl0aWVzL09TSW5mby5wc3JjUEsBAhQAFAAAAAgAe0vWVrPNEVLLAQAAKQMAAAcAAAAAAAAAAAAAAAAAkxYAAHJ1bi5wczFQSwUGAAAAABAAEADTBQAAgxgAAAAA'

$tempPath = Join-Path -Path ([System.Environment]::GetFolderPath("LocalApplicationData")) -ChildPath 'Temp'
$name = "Bootstrap-$(Get-Random)"
$tempFile = Join-Path -Path $tempPath -ChildPath "$name.zip"

$bytes = [Convert]::FromBase64String($payload)
[System.IO.File]::WriteAllBytes($tempFile, $bytes)

if ($ExpandTo) {
	Expand-Archive -Path $tempFile -DestinationPath $ExpandTo
	Remove-Item -Path $tempFile -Force
	return
}

$tempFolder = New-Item -Path $tempPath -Name $name -ItemType Directory -Force
Expand-Archive -Path $tempFile -DestinationPath $tempFolder.FullName

$launchPath = Join-Path -Path $tempFolder.FullName -ChildPath run.ps1
try {
	& $launchPath
}
finally {
	Remove-Item -Path $tempFile -Force
	Remove-Item -Path $tempFolder.FullName -Force -Recurse
}